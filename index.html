<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.css">
  <style>
    .datahub-meta {
      display: none;
    }
    .share-and-embed {
      display: none;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="page-header">
  </div>
  <div>
    <select onchange="selectPeriod(this)">
      <option value="week">1 week</option>
      <option value="month">1 month</option>
      <option value="year">1 year</option>
      <option value="fiveYears">5 years</option>
      <option value="all">All</option>
    </select>
  </div>
  <div class="react-me" data-type="data-views"></div>
  <div class="react-me" data-type="resource-preview" data-resource="0"></div>
</div>
  <script type="text/javascript">
    function selectPeriod(mySelect) {
      switch (mySelect.value) {
        case 'week':
          window.location.href = '/week';
          break;
        case 'month':
          window.location.href = '/month';
          break;
        case 'year':
          window.location.href = '/year';
          break;
        case 'fiveYears':
          window.location.href = '/fiveYears';
          break;
        case 'all':
          window.location.href = '/all';
          break;
      }
    };


    var resp ;
    var xmlHttp ;

    resp  = '' ;
    xmlHttp = new XMLHttpRequest();

    if (xmlHttp != null) {
        xmlHttp.open( "GET", 'https://datahub.io/core/co2-ppm-daily/datapackage.json', false );
        xmlHttp.send( null );
        resp = xmlHttp.responseText;
    }

    var DP_ID = JSON.parse(resp);
    DP_ID.views[0].resources = [
      {
        "name": "co2-ppm-daily",
        "transform": []
      }
    ];

    switch (window.location.href.split('/')[3]) {
      case 'week':
        DP_ID.views[0].resources[0].transform[0] = {
          "type": "filter",
          "expression": "(new Date(data['date'])).getFullYear() >= 2017"
        };
        break;
      case 'month':
        DP_ID.views[0].resources[0].transform[0] = {
          "type": "filter",
          "expression": "(new Date(data['date'])).getFullYear() >= 2016"
        };
        break;
      case 'year':
        DP_ID.views[0].resources[0].transform[0] = {
          "type": "filter",
          "expression": "(new Date(data['date'])).getFullYear() >= 2015"
        };
        break;
      case '':
      case undefined:
      case 'fiveYears':
        DP_ID.views[0].resources[0].transform[0] = {
          "type": "filter",
          "expression": "(new Date(data['date'])).getFullYear() >= 2014"
        };
        break;
      case 'all':
        DP_ID.views[0].resources[0].transform = [];
        break;
    };
  </script>
</body>
